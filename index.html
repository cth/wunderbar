<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <title>Wunderbar by cth</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>Wunderbar</h1>
        <h2>wunderbar</h2>

        <section id="downloads">
          <a href="https://github.com/cth/wunderbar/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/cth/wunderbar/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/cth/wunderbar" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <pre><code> __      __                  .___          ___.                 
/  \    /  \__ __  ____    __| _/__________\_ |__ _____ _______ 
\   \/\/   /  |  \/    \  / __ |/ __ \_  __ \ __ \\__  \\_  __ \
 \        /|  |  /   |  \/ /_/ \  ___/|  | \/ \_\ \/ __ \|  | \/
  \__/\  / |____/|___|  /\____ |\___  &gt;__|  |___  (____  /__|   
       \/             \/      \/    \/          \/     \/
</code></pre>

<h1>
<a name="about" class="anchor" href="#about"><span class="octicon octicon-link"></span></a>About</h1>

<p>Wunderbar is a program which is able to identify mislabeled samples in genotype data 
when a few extra independent genotypes are available ( “genetic barcoding“ ). </p>

<p>Wunderbar calculates probabilities of the likelihood that genotype mismatches have occurred by chance. 
It is capable of reliable and sensitive detection of sample mismatches and swaps even in the presence
of numerous genotyping errors and in the presence of linkage disequibrilium between the individual 
genotypes. It only requires a few SNPs to work well.</p>

<h1>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h1>

<p>Wunderbar requires files that in plink format, see <a href="http://pngu.mgh.harvard.edu/%7Epurcell/plink/">http://pngu.mgh.harvard.edu/~purcell/plink/</a> .
Moreover, the files must be in the non-binary, with alleles recoded numerically and tab-separated.
To convert a binary plink file to the required format, use a command similar too:</p>

<pre><code>plink --bfile my-binary-plink --recode12 --tab --out my-wunder-ready-plink
</code></pre>

<p>Wunderbar expects that you have two plink file-sets: A file-set with barcoding genotypes and 
a file-set with the genotypes that you with to do barcoding against. Then to run barcoding
you would use a command like:</p>

<pre><code>./wunderbar --barcode-file my-barcodes --file my-test-genotypes --sampling-iterations 10000 --out results
</code></pre>

<p>This will create the files <code>results.mismatch</code> (candidate list of mismatching samples) and <code>results.swaps</code>
(candidate list of mixed up samples).</p>

<p>The full list of options are:</p>

<pre><code>Usage: wunderbar [options]
    -h, --help                       Display this screen
    -f, --file plinkstem             The genotypes to be tested
    -b, --barcode-file plinkstem     The barcode genotypes
    -o, --out file                   Prefix of the output files
        --ld-adjust iterations       Adjust for population LD structure between barcoding SNPs. Default number of iterations is 0 (Assume no LD). The more iterations the more precise the adjustment.
        --sampling-iterations iterations
                                 Number of iterations to use to calculate p-value from mismatch probability distribution
    --peturb 0..1                A very small pertubation constant to ensure that no sample gets zero mismatch probability (default 0)
    --dot-file file              Create .dot file for GraphViz to visualize swaps
</code></pre>

<h1>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h1>

<pre><code>Copyright (C) 2014 Christian Theil Have

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
</code></pre>
      </section>
    </div>

    
  </body>
</html>